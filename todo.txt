// TODO: decrease the number of simulation functions to one with template metaprogramming
